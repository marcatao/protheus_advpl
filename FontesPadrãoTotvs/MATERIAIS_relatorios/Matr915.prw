#INCLUDE "MATR915.CH"
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁPrograma  Ё  MATR915 Ё Autor Ё Eduardo Ju            Ё Data Ё 04.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o ЁListagem de Conferencia da GiaRJ                            Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁRetorno   ЁNenhum                                                      Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁNenhum                                                      Ё╠╠
╠╠Ё          Ё                                                            Ё╠╠
╠╠цддддддддддедддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё   DATA   Ё Programador   ЁManutencao efetuada                         Ё╠╠
╠╠цддддддддддедддддддддддддддедддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё          Ё               Ё                                            Ё╠╠
╠╠юддддддддддадддддддддддддддадддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/

Function Matr915()
	Local 	Titulo  := OemToAnsi(STR0001) //"Listagem de Conferencia da GIA-RJ"             
	Local 	cDesc1  := OemToAnsi(STR0002) //"Este programa permite listar quais sao informacoes  "  
	Local 	cDesc2  := OemToAnsi(STR0003) //"geradas em Arquivo Magnetico e que serao validadas  "  
	Local 	cDesc3  := OemToAnsi(STR0004) //"pela Secretaria da Fazenda do Rio de Janeiro."                              
	Local 	cAlias  := "SF3"  // Alias utilizado na Filtragem
	Local 	lDic    := .F. // Habilita/Desabilita Dicionario
	Local 	lComp   := .T. // Habilita/Desabilita o Formato Comprimido/Expandido
	Local 	lFiltro := .F. // Habilita/Desabilita o Filtro
	Local 	wnrel   := "MATR915"  
	Local 	nomeprog:= "MATR915"
	Local 	nAno  	:= 0
	Local 	nMes  	:= 0
	Local 	aDatas	:= {}
	Local 	lVerpesssen := Iif(FindFunction("Verpesssen"),Verpesssen(),.T.)
	Private Tamanho := "M" // P/M/G
	Private Limite  := 132 // 80/132/220
	Private aOrdem  := {}  // Ordem do Relatorio
	Private cPerg   := "GIARJ "  // Pergunta do Relatorio
	Private aReturn := { STR0005, 1,STR0006, 1, 2, 1, "",1 } //"Zebrado"###"Administracao"
	Private lEnd    := .F.// Controle de cancelamento do relatorio
	Private nPagina := 1  // Contador de Paginas
	Private nLastKey:= 0  // Controla o cancelamento da SetPrint e SetDefault 
	If lVerpesssen
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁVerifica as Perguntas Seleciondas                                       Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		Pergunte(cPerg,.F.)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁEnvia para a SetPrinter                                                 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		wnrel:=SetPrint(cAlias,wnrel,cPerg,@titulo,cDesc1,cDesc2,cDesc3,lDic,aOrdem,lComp,Tamanho,lFiltro)
		//
		If ( nLastKey==27 )
			dbSelectArea(cAlias)
			dbSetOrder(1)
			Set Filter to
			Return
		Endif
		//
		SetDefault(aReturn,cAlias)
		//
		If ( nLastKey==27 )
			dbSelectArea(cAlias)
			dbSetOrder(1)
			Set Filter to
			Return
		Endif     
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁChamada da Funcao que retorna Data Inicial e Data Final                 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		nAno  := mv_par01
		nMes  := mv_par02
		aDatas:=DetDatas(nMes,nAno,3,1)
		dDtIni:=aDatas[1]
		dDtFim:=aDatas[2] 
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁChamada da Funcao ResumeF3 (Apuracao do ICMS) Fisxapur.prx              Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		ResumeF3("IC",dDtIni,dDtFim,"*",.F.,.T.,1,.F.,2,Nil,Nil,{},{},"",.T.,"ICM",,,.F.)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//ЁChamada da Funcao  FisApur (Apuracao do ICMS) Fisxapur.prx              Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		FisApur("IC",val(Substr(DTOS(dDtFim),1,4)),val(Substr(DTOS(dDtFim),5,2)),2,0,"*",.F.,{},1,.T.,"PUR","")
		//
		RptStatus({|lEnd| ImpDet(@lEnd,wnRel,cAlias,nomeprog,Titulo)},Titulo)
	EndIf
Return(.T.)
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁProgram   Ё ImpDet   Ё Autor Ё Eduardo Ju            Ё Data Ё04.08.2003Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o ЁControle de Fluxo do Relatorio.                             Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁRetorno   ЁNenhum                                                      Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ                                                            Ё╠╠
╠╠цддддддддддедддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё   DATA   Ё Programador   ЁManutencao efetuada                         Ё╠╠
╠╠цддддддддддедддддддддддддддедддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё          Ё               Ё                                            Ё╠╠
╠╠юддддддддддадддддддддддддддадддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function ImpDet(lEnd,wnrel,cAlias,nomeprog,Titulo)
	Local li      := 100 // Contador de Linhas
	Local lImp    := .F. // Indica se algo foi impresso
    //
	DbSelectArea(cAlias)
	SetRegua((cAlias)->(LastRec()))
	DbSetOrder(1)
	DbSeek(xFilial(cAlias))
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Execucao do relatorio                                        Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	RptStatus({|lEnd| R915Imp(@lEnd,wnRel,cAlias,Tamanho)},titulo)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Restaura Ambiente                                            Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	dbSelectArea(cAlias)
	dbClearFilter()
	//		
	Set Device To Screen
	Set Printer To
	If ( aReturn[5] = 1 )
		dbCommitAll()
		OurSpool(wnrel)
	Endif
	MS_FLUSH()
Return(.T.)
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё R915Imp  Ё Autor Ё Eduardo Ju            Ё Data Ё 05.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Chama Funcao Matr915 - Utilizado para Gerar Relatorio      Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function R915Imp(lEnd,WnRel,cAlias,Tamanho)
	Local	nLinPag	:=	55
	Private nTotReg := 2    //Contador de Registros, inicializado c/2 pelo fato de nao considerar Reg Tipo 0000
	Private nSomaVal:= 0    //Somatoria de todos os Valores Mencionados
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro Identificador da Declaracao         Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0110(nLinPag)  
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Entradas         Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0120(nLinPag)  
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Saidas           Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0130(nLinPag)   
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registros: 0140 / 0150 / 0160 / 0170 / 0180  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддды
	RegApur(nLinPag)      
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Operacoes com Prazo Especial Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0190(nLinPag) 
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Outros ICMS devido  Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0200(nLinPag)   
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Entradas Interestaduais  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	DbSelectArea("ICM")
		dbCloseArea()
	ResumeF3("IC",dDtIni,dDtFim,"*",.F.,.T.,1,.F.,2,Nil,Nil,{},{},"",.T.,"ICM",,,.T.)
	Reg0210(nLinPag)  
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Saidas Interestaduais    Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0220(nLinPag)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de Saidas para ZFM/ALC      Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0230(nLinPag)
	//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de SCE Compensado entre Estabelecimentos Ё
	//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0240(nLinPag)  
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de SCE Compensado do ProprioЁ
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0250(nLinPag)       
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de SCE Recebido             Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0260(nLinPag)  
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro de Movimentacao de SCE Transferido          Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Reg0270(nLinPag)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Imprime Registro Trailler do Arquivo (Somatoria dos Valores) Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	//Reg9999(nLinPag)
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Fecha Arquivos Utilizados                                    Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	DbSelectArea("ICM")
	dbCloseArea()
	//	
	DbSelectArea("PUR")
	dbCloseArea()
	//
	DbSelectArea("SX5")
	dbCloseArea() 
	//
	DbSelectArea("SA1")
	dbCloseArea()
	//
	DbSelectArea("SA2")
	dbCloseArea()
	//
	DbSelectArea("SF3")
	dbCloseArea()
Return
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0110  Ё Autor Ё Eduardo Ju            Ё Data Ё 14.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro Identificador da Declaracao                       Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0110(nLinPag)
	Local 	cTipo       := "" 
	Local 	nLin 		   := 0 
	Local 	cInsc_Estad := SM0->M0_INSC
	Local 	nAA_Referen := StrZero (mv_par01, 4)
	Local 	nMM_Referen := StrZero (mv_par02, 2)
	Local 	cInd_Retif  := IIf(mv_par03==1,"S","N")
	Local 	cNomeReprLeg:= mv_par04
	Local 	cDDD_ReprLeg:= mv_par05
	Local 	cTel_ReprLeg:= mv_par06
	Local 	cNom_Ctabil := mv_par07
	Local 	cEmail      := mv_par08
	Local 	cDDD_Ctabil := mv_par09
	Local 	cTel_Ctabil := mv_par10
	Local 	nValSaldoAnt:= mv_par11
	Local 	nValSalAntST:= mv_par12
	Local 	cObs        := mv_par13
	Local 	cObs_ST     := mv_par14
	Local 	nValAntSCE  := mv_par15
	Local 	nValCrdSCE  := mv_par16
	Local 	nValEstSCE  := mv_par17
	Local 	nValProvSCE := mv_par18
	Local 	cInd_Mop    := IIF(mv_par19==1,"S","N")
	Local 	cInd_Mtribut:= IIF(mv_par20==1,"S","N")
	Local 	cInd_MICMS  := IIF(mv_par21==1,"S","N")
	Local 	cInd_MALCZFM:= IIF(mv_par22==1,"S","N")
	Local	aL 			:= R915LayOut()
	//	  
	cTipo:= "0110"  
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Rotina de Impressao do Registro 0110                         Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If nLin == 0
		R915Cabec(aL,@nLin,@nPagina,cTipo)
	Endif                  
	// 			 
	FmtLin ({Transform(cInsc_Estad,"@R 999.999.999.999")},al[07],,,@nLin)
	FmtLin ({nAA_Referen},al[08],,,@nLin)
	FmtLin ({nMM_Referen},al[09],,,@nLin)
	FmtLin ({cInd_Retif},al[10],,,@nLin)
	FmtLin ({cNomeReprLeg},al[11],,,@nLin)
	FmtLin ({cDDD_ReprLeg},al[12],,,@nLin)
	FmtLin ({cTel_ReprLeg},al[13],,,@nLin)
	FmtLin ({cNom_Ctabil},al[14],,,@nLin)
	FmtLin ({cEmail},al[15],,,@nLin)
	FmtLin ({cDDD_Ctabil},al[16],,,@nLin)
	FmtLin ({cTel_Ctabil},al[17],,,@nLin)
	FmtLin ({nValSaldoAnt},al[18],,,@nLin)
	FmtLin ({nValSalAntST},al[19],,,@nLin)
	FmtLin ({cObs},al[20],,,@nLin)
	FmtLin ({cObs_ST},al[21],,,@nLin)
	FmtLin ({nValAntSCE},al[22],,,@nLin)
	FmtLin ({nValCrdSCE},al[23],,,@nLin)
	FmtLin ({nValEstSCE},al[24],,,@nLin)
	FmtLin ({nValProvSCE},al[25],,,@nLin)
	FmtLin ({cInd_Mop},al[26],,,@nLin)
	FmtLin ({cInd_Mtribut},al[27],,,@nLin)
	FmtLin ({cInd_MICMS},al[28],,,@nLin)
	FmtLin ({cInd_MALCZFM},al[29],,,@nLin)
	FmtLin ({},al[30],,,@nLin) 
	//	
	nTotReg += 1
	nSomaVal+= nValSaldoAnt+nValSalAntST+nValAntSCE+nValCrdSCE+nValEstSCE+nValProvSCE   
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0120  Ё Autor Ё Eduardo Ju            Ё Data Ё 14.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Entradas                       Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0120(nLinPag)
	Local cTipo       	:= ""
	Local nLin        	:= 0
	Local cCod_FisOp  	:= ""	
	Local nVal_ctabil 	:= 0
	Local nVal_BasCalc	:= 0
	Local nVal_Imposto	:= 0
	Local nVal_OpIsent	:= 0
	Local nVal_OutraOP	:= 0
	Local nVal_CalcST 	:= 0
	Local nVal_Retido 	:= 0
	Local lImprime    	:= .F. 
	Local	nTotVlrCont	:=	0
	Local	nTotVlrBC	:=	0
	Local	nTotVlrImp	:=	0
	Local	nTotVlrIsen	:=	0
	Local	nTotVlrOut	:=	0
	Local	aL 			:= R915LayOut()
	Local	lTotaliza	:=	.F.
	//
	cTipo := ""
	//
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If Substr(CFOP,1,1) < "5" 
			lImprime    := .T.
			cTipo       := "0120"
			cCod_FisOp  := ICM->CFOP	
			nVal_ctabil := ICM->VALCONT
			nVal_BasCalc:= ICM->BASEICM
			nVal_Imposto:= ICM->VALICM
			nVal_OpIsent:= ICM->ISENICM
			nVal_OutraOP:= ICM->OUTRICM
			nVal_CalcST := ICM->BASERET
			nVal_Retido := ICM->ICMSRET 
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0120                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
				If nLin>=nLinPag
					FmtLin({},al[39],,,@nLin)
					nLin := 2
				EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cCod_FisOp,nVal_ctabil,nVal_BasCalc,nVal_Imposto,nVal_OpIsent,nVal_OutraOP},al[38],,,@nLin) 
			//зддддддддддддддддддддд©
			//ЁTotalizando registrosЁ
			//юддддддддддддддддддддды
			nTotVlrCont	+=	nVal_ctabil
			nTotVlrBC	+=	nVal_BasCalc
			nTotVlrImp	+=	nVal_Imposto
			nTotVlrIsen	+=	nVal_OpIsent
			nTotVlrOut	+=	nVal_OutraOP		
			lTotaliza	:=	.T.
			//
			nTotReg += 1
			nSomaVal+= ICM->VALCONT+ICM->BASEICM+ICM->VALICM+ICM->ISENICM+ICM->OUTRICM
		EndIf   	
		DbSkip()
	EndDo  
	//
	If (lTotaliza)
		FmtLin({},al[37],,,@nLin)
		FmtLin({"", nTotVlrCont, nTotVlrBC, nTotVlrImp, nTotVlrIsen, nTotVlrOut},al[38],,,@nLin)
		FmtLin({},al[39],,,@nLin)
	EndIf
Return
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0130  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Saidas                         Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0130(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cCod_FisOp  := ""	
	Local nVal_ctabil := 0
	Local nVal_BasCalc:= 0
	Local nVal_Imposto:= 0
	Local nVal_OpIsent:= 0
	Local nVal_OutraOP:= 0
	Local nVal_CalcST := 0
	Local nVal_Retido := 0 
	Local lImprime    := .F.
	Local	nTotVlrCont	:=	0
	Local	nTotVlrBC	:=	0
	Local	nTotVlrImp	:=	0
	Local	nTotVlrIsen	:=	0
	Local	nTotVlrOut	:=	0 
	Local 	nTotVlrCST	:= 	0
	Local	nTotVlrRet	:=	0
	Local	aL := R915LayOut()
	Local	lTotaliza	:=	.F.
	//
	cTipo := ""
	//
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If Substr(CFOP,1,1) >= "5" 
			lImprime    := .T.
			cTipo       := "0130"
			cCod_FisOp  := ICM->CFOP
			nVal_ctabil := ICM->VALCONT
			nVal_BasCalc:= ICM->BASEICM
			nVal_Imposto:= ICM->VALICM
			nVal_OpIsent:= ICM->ISENICM
			nVal_OutraOP:= ICM->OUTRICM
			If mv_par20==1 // Apresenta valores de ST
				nVal_CalcST := ICM->BASERET
				nVal_Retido := ICM->ICMSRET
			Endif
			
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0130                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
				If nLin>=nLinPag				
					FmtLin({},al[49],,,@nLin)
					nLin := 2
				EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//

			FmtLin({cCod_FisOp,nVal_ctabil,nVal_BasCalc,nVal_Imposto,nVal_OpIsent,nVal_OutraOP,nVal_CalcST,nVal_Retido},al[48],,,@nLin)

			//здддддддддддддддддддддд©
			//ЁTotalizando variaveis.Ё
			//юдддддддддддддддддддддды
			nTotVlrCont	+=	nVal_ctabil
			nTotVlrBC	+=	nVal_BasCalc
			nTotVlrImp	+=	nVal_Imposto
			nTotVlrIsen	+=	nVal_OpIsent
			nTotVlrOut	+=	nVal_OutraOP
			nTotVlrCST	+=	nVal_CalcST
			nTotVlrRet	+=	nVal_Retido             
			
			lTotaliza	:=	.T.
		    //
			nTotReg += 1
			nSomaVal+= ICM->VALCONT+ICM->BASEICM+ICM->VALICM+ICM->ISENICM+ICM->OUTRICM
		EndIf		
		dbskip()
	EndDo
	//
	If (lTotaliza)
		FmtLin({},al[47],,,@nLin)
		FmtLin({"", nTotVlrCont, nTotVlrBC, nTotVlrImp, nTotVlrIsen, nTotVlrOut, nTotVlrCST, nTotVlrRet},al[48],,,@nLin)
		FmtLin({},al[49],,,@nLin)
	EndIf
Return
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё RegApur  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Outros Debitos                 Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function RegApur(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local nVal_OutDeb := 0
	Local nVal_EstCrd := 0
	Local nVal_OutCrd := 0
	Local nVal_EstDeb := 0
	Local nVal_Deducao:= 0
	Local cDesc_Compl := ""
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotVlr	:=	0
	Local	lCabec	:=	.T.
	// 
	cTipo := ""
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	//
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If PUR->CODIGO == "002" .And. Alltrim(PUR->SUBCOD) == "002.00" .And. PUR->VALOR > 0			
			lImprime    := .T.
			cTipo:= "0140"
			cSeq_Ocorr  := Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_OutDeb := PUR->VALOR
			cDesc_Compl := PUR->DESCR
			//
			If (lCabec)
				R915Cabec(aL,@nLin,@nPagina,cTipo)
				lCabec	:=	.F.
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0140                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If nLin>=nLinPag .And. lImprime
		   		If (nLin>=nLinPag)
					FmtLin({},al[59],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//			
			FmtLin({cSeq_Ocorr,nVal_OutDeb,cDesc_Compl},al[58],,,@nLin)
			//	
			nTotReg += 1
			nSomaVal+= PUR->VALOR
			nTotVlr+= PUR->VALOR
		EndIf		
		dbskip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[57],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[58],,,@nLin)
		FmtLin({},al[59],,,@nLin)	
	EndIf
	//
	nTotVlr		:=	0
	lImprime	:=	.F.
	cTipo   	:= ""
	lCabec		:=	.T.
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If PUR->CODIGO == "003" .And. Alltrim(PUR->SUBCOD) == "003.00" .And. PUR->VALOR > 0
			lImprime	:=	.T.
			cTipo      := "0150"
			cSeq_Ocorr := Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_EstCrd:= PUR->VALOR
			cDesc_Compl:= PUR->DESCR
			//
			If (lCabec)
				FmtLin({},aL[61],,,@nLin)
				FmtLin({},aL[62],,,@nLin)
				FmtLIn({},al[63],,,@nLin)
				FmtLIn({},al[64],,,@nLin)
				FmtLIn({},al[65],,,@nLin)
				FmtLIn({},al[66],,,@nLin)
				FmtLIn({},al[67],,,@nLin)
				lCabec	:=	.F.
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0150                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If nLin>=nLinPag .And. lImprime
		   		If (nLin>=nLinPag)
					FmtLin({},al[69],,,@nLin)	
					nLin := 2
		   		EndIf
				FmtLin({},aL[61],,,@nLin)
				FmtLin({},aL[62],,,@nLin)
				FmtLIn({},al[63],,,@nLin)
				FmtLIn({},al[64],,,@nLin)
				FmtLIn({},al[65],,,@nLin)
				FmtLIn({},al[66],,,@nLin)
				FmtLIn({},al[67],,,@nLin)                  
			EndIf
			//
			FmtLin({cSeq_Ocorr,nVal_EstCrd,cDesc_Compl},al[68],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= PUR->VALOR		
			nTotVlr	+=	PUR->VALOR
		EndIf		
		dbskip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[67],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[68],,,@nLin)
		FmtLin({},al[69],,,@nLin)	
	EndIf
	//
	nTotVlr		:=	0
	lImprime	:=	.F.
	cTipo 		:= ""
	lCabec		:=	.T.
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If PUR->CODIGO == "006" .And. Alltrim(PUR->SUBCOD) <> "006.00" .And. PUR->VALOR > 0
			lImprime	:=	.T.
			cTipo      := "0160"
			cSeq_Ocorr := Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_OutCrd:= PUR->VALOR
			cDesc_Compl:= PUR->DESCR
			//
			If (lCabec)
				FmtLin({},aL[71],,,@nLin)
				FmtLin({},aL[72],,,@nLin)
				FmtLIn({},al[73],,,@nLin)
				FmtLIn({},al[74],,,@nLin)
				FmtLIn({},al[75],,,@nLin)
				FmtLIn({},al[76],,,@nLin)
				FmtLIn({},al[77],,,@nLin)
				lCabec	:=	.F.
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0160                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If nLin>=nLinPag .And. lImprime	
		   		If (nLin>=nLinPag)
					FmtLin({},al[79],,,@nLin)	
					nLin := 2
		   		EndIf
				FmtLin({},aL[71],,,@nLin)
				FmtLin({},aL[72],,,@nLin)
				FmtLIn({},al[73],,,@nLin)
				FmtLIn({},al[74],,,@nLin)
				FmtLIn({},al[75],,,@nLin)
				FmtLIn({},al[76],,,@nLin)
				FmtLIn({},al[77],,,@nLin)
			EndIf
			//
			FmtLin({cSeq_Ocorr,nVal_OutCrd,cDesc_Compl},al[78],,,@nLin)
			//
			nTotReg += 1
			nSomaVal+= PUR->VALOR 
			nTotVlr	+= PUR->VALOR 
		EndIf		
		dbskip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[77],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[78],,,@nLin)
		FmtLin({},al[79],,,@nLin)	
	EndIf
	//
	nTotVlr		:=	0
	lImprime	:=	.F.
	cTipo 		:= ""
	lCabec		:=	.T.
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If PUR->CODIGO == "007" .And. Alltrim(PUR->SUBCOD) == "007.00" .And. PUR->VALOR > 0
			cTipo      	:= "0170"
			cSeq_Ocorr 	:= Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_EstDeb	:= PUR->VALOR
			cDesc_Compl	:= PUR->DESCR
			lImprime	:=	.T.
			//
			If (lCabec)
				FmtLin({},aL[81],,,@nLin)
				FmtLin({},aL[82],,,@nLin)
				FmtLIn({},al[83],,,@nLin)
				FmtLIn({},al[84],,,@nLin)
				FmtLIn({},al[85],,,@nLin)
				FmtLIn({},al[86],,,@nLin)
				FmtLIn({},al[87],,,@nLin)
				lCabec	:=	.F.
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0170                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If nLin>=nLinPag .And. lImprime	
		   		If (nLin>=nLinPag)
					FmtLin({},al[89],,,@nLin)	
					nLin := 2
		   		EndIf
				FmtLin({},aL[81],,,@nLin)
				FmtLin({},aL[82],,,@nLin)
				FmtLIn({},al[83],,,@nLin)
				FmtLIn({},al[84],,,@nLin)
				FmtLIn({},al[85],,,@nLin)
				FmtLIn({},al[86],,,@nLin)
				FmtLIn({},al[87],,,@nLin)        
			EndIf
			//
			FmtLin({cSeq_Ocorr,nVal_EstDeb,cDesc_Compl},al[88],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= PUR->VALOR
			nTotVlr	+= PUR->VALOR
		EndIf		
		dbskip()
	EndDo 
	//
	If (lImprime)
		FmtLin({},al[87],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[88],,,@nLin)
		FmtLin({},al[89],,,@nLin)	
	EndIf
	//
	nTotVlr		:=	0
	lImprime	:=	.F.
	cTipo 		:= ""
	lCabec		:=	.T.
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof()
	
		If Interrupcao(@lEnd)
			Loop
		Endif
		
		// Mesma regra de codigos do GIARJ.INI para geracao do tipo de ocorrencia "0180" no arquivo magnetico.
		// Gerar os lancamentos detalhados, conforme a apuraГЦo de ICMS, e nao apenas o valor total de deducoes.
		 
		If PUR->CODIGO == "012" .And. Alltrim(PUR->SUBCOD) <> "012.00" .And. Alltrim(PUR->SUBCOD) <> "012.30" .And. PUR->VALOR > 0
			cTipo       := "0180"
			cSeq_Ocorr  := Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_Deducao:= PUR->VALOR
			cDesc_Compl := PUR->DESCR
			lImprime	:=	.T.
			//
			If (lCabec)
				FmtLin({},aL[91],,,@nLin)
				FmtLin({},aL[92],,,@nLin)
				FmtLIn({},al[93],,,@nLin)
				FmtLIn({},al[94],,,@nLin)
				FmtLIn({},al[95],,,@nLin)
				FmtLIn({},al[96],,,@nLin)
				FmtLIn({},al[97],,,@nLin)
				lCabec	:=	.F.
			EndIf
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0180                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If nLin>=nLinPag .And. lImprime	
		   		If (nLin>=nLinPag)
					FmtLin({},al[99],,,@nLin)	
					nLin := 2
		   		EndIf
				FmtLin({},aL[91],,,@nLin)
				FmtLin({},aL[92],,,@nLin)
				FmtLIn({},al[93],,,@nLin)
				FmtLIn({},al[94],,,@nLin)
				FmtLIn({},al[95],,,@nLin)
				FmtLIn({},al[96],,,@nLin)
				FmtLIn({},al[97],,,@nLin)
			EndIf
			//
			FmtLin({cSeq_Ocorr,nVal_Deducao,cDesc_Compl},al[98],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= PUR->VALOR
			nTotVlr	+= PUR->VALOR
		EndIf	
			
		dbskip()
		
	EndDo
	
	If (lImprime)
		FmtLin({},al[97],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[98],,,@nLin)
		FmtLin({},al[99],,,@nLin)	
	EndIf
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0190  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Operacoes com Prazo Especial   Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0190(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local nVal_PrzEsp := 0
	Local cDesc_Compl := ""	
	Local lImprime    := .F.
	Local	nTotVlr	:=	0
	//
	cTipo := ""
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	//
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If PUR->CODIGO == "0000"
			lImprime   := .T.
			cTipo      := "0190"
			cSeq_Ocorr := Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_PrzEsp:= PUR->VALOR
			cDesc_Compl:= PUR->DESCR
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0190                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//	
			If (nLin==0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[109],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cSeq_Ocorr,nVal_PrzEsp,cDesc_Compl},al[108],,,@nLin) 
			 //
			nTotReg += 1
			nSomaVal+= PUR->VALOR
			nTotVlr	+= PUR->VALOR
		EndIf		
		dbskip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[107],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[108],,,@nLin)
		FmtLin({},al[109],,,@nLin)	
	EndIf
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0200  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Outros ICMS devido             Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0200(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local nVal_Lanc   := 0
	Local cDesc_Compl := ""	
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotVlr	:=	0
	//
	cTipo := ""
	//
	DbSelectArea("PUR")
	SetRegua(LastRec())
	DbGoTop() 
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
		Endif 
		//If (AllTrim (PUR->CODIGO)$"/019/020/" .OR.;
		If	((ALLTRIM(PUR->CODIGO)=="012" .And. Alltrim(StrTran(PUR->SUBCOD,".",""))=="01201") .OR.;
			(Alltrim(PUR->CODIGO)=="900" .And. Alltrim(StrTran(PUR->SUBCOD,".","")) $ "00169#00170#00207#00208#00209#00210#00274") .Or.;
			 ("DIFAL"$UPPER(ALLTRIM(PUR->DESCR)))) .And. PUR->VALOR > 0
			 
			lImprime   := .T.
			cTipo      := "0200"
			cSeq_Ocorr := Alltrim(StrTran(PUR->SUBCOD,".",""))
			nVal_Lanc  := PUR->VALOR
			cDesc_Compl:= AllTrim(PUR->DESCR)
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0200                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If (nLin==0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[119],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cSeq_Ocorr,nVal_Lanc,cDesc_Compl},al[118],,,@nLin) 
		    //
			nTotReg += 1
			nSomaVal+= PUR->VALOR
			nTotVlr	+=	PUR->VALOR
		EndIf		
		dbskip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[117],,,@nLin)
		FmtLin({"", nTotVlr, ""},al[118],,,@nLin)
		FmtLin({},al[119],,,@nLin)	
	EndIf
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0210  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Entradas Interestaduais        Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0210(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cCod_UF     := ""
	Local nVal_ctabil := 0
	Local nVal_BasCalc:= 0
	Local nVal_OutraOP:= 0
	Local nVal_OutProd:= 0
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotCont	:=	0
	Local	nTotBC		:=	0
	Local	nTotOut		:=	0
	Local	nTotOutP	:=	0
	Local	nTotVlr	:=	0
	Local   aDados		:=	{}
	Local	nDados		:=	0
	Local	nI			:=	0
	//
	cTipo := ""
	//
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop()
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If Subs(ICM->CFOP,1,1) == "2"
			lImprime    := .T.
			cTipo       := "0210"
			cCod_UF     := ICM->UF
			nVal_ctabil := ICM->VALCONT
			nVal_BasCalc:= ICM->BASEICM
			nVal_OutraOP:= ICM->OUTRICM + ICM->ISENICM 
			nVal_OutProd:= ICM->ICMSRET
			//
			nTotCont	+=	ICM->VALCONT
			nTotBC		+=	ICM->BASEICM
			nTotOut		+=	ICM->OUTRICM + ICM->ISENICM 
			nTotOutP	+=	ICM->ICMSRET
			
						
			nDados	:= ascan(aDados,{|x| x[1]=cCod_UF})
			If nDados == 0
				aAdd(aDados,{cCod_UF,nVal_ctabil,nVal_BasCalc,nVal_OutraOP,nVal_OutProd})
			Else	
			   aDados[nDados][2]+=nVal_ctabil
			   aDados[nDados][3]+=nVal_BasCalc
			   aDados[nDados][4]+=nVal_OutraOP
			   aDados[nDados][5]+=nVal_OutProd
			EndIf

			nTotReg += 1
			nSomaVal+= ICM->VALCONT+ICM->BASEICM+ICM->OUTRICM+ICM->ICMSRET+ICM->ISENICM
			nTotVlr	+=	ICM->VALCONT+ICM->BASEICM+ICM->OUTRICM+ICM->ICMSRET+ICM->ISENICM
		EndIf
		DbSkip()
	EndDo
			
	For nI:=1 to len(aDados)
		If Interrupcao(@lEnd)
			Loop
		Endif 
		
		IncRegua()
			
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0210                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			//
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[129],,,@nLin)	
					nLin := 2
	   			EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
		//
		FmtLin(adados[nI],al[128],,,@nLin)
	Next nI
	
	//
	If (lImprime)
		FmtLin({},al[127],,,@nLin)
		FmtLin({"", nTotCont, nTotBC, nTotOut, nTotOutP},al[128],,,@nLin)
		FmtLin({},al[129],,,@nLin)	
	EndIf
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0220  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Saidas Interestaduais          Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0220(nLinPag)
	Local 	cTipo        := ""
	Local 	nLin         := 0
	Local 	cCod_UF      := ""
	Local 	nValCtaNcont := 0
	Local 	nValCtaContr := 0
	Local 	nValBasNcont := 0
	Local 	nValBasContr := 0
	Local 	nVal_OutraOP := 0
	Local 	nVal_ImpST   := 0 
	Local 	_aTotal      := {}
	Local 	lImprime     := .F.
	Local	aL := R915LayOut()
	Local	nTotCtaN	:=	0
	Local	nTotCta		:=	0
	Local	nTotBNC		:=	0
	Local	nTotBC		:=	0
	Local	nTotOut		:=	0
	Local	nTotSt		:=	0
	Local	aDados		:=	{}
	Local	nDados		:=	0
	Local	nI			:=	0
	Local   lContrib    := .T.
	//
	cTipo := ""
	//
	DbSelectArea("SA1")
	SA1->(dbSetOrder(1))
	DbSelectArea("SA2")
	SA2->(dbSetOrder(1))
	DbSelectArea("SF3")
	SF3->(dbSetOrder(1))
	//
	_aTotal := {"SF3",""}
	FsQuery(_aTotal,1,"F3_FILIAL='"+xFilial("SF3")+"' And F3_EMISSAO>='"+Dtos(dDtIni)+"' And F3_EMISSAO<='"+Dtos(dDtFim)+"' And F3_DTCANC='' And F3_CODISS='' And F3_TIPO<>'S' And F3_OBSERV NOT IN ('CANCELAD')","F3_FILIAL=='"+ xFilial("SF3") +"' .and. DTOS(F3_EMISSAO)>='"+ DTOS(dDtIni) +"' .and. DTOS(F3_EMISSAO)<='"+ DTOS(dDtFim) +"' .And. Empty(F3_DTCANC) .And. Empty(F3_CODISS) .And. F3_TIPO<>'S' .And. !'CANCELAD'$F3_OBSERV",SF3->(IndexKey()))
	//
	SetRegua(LastRec())             
	SF3->(DbGoTop())
	//
	While !Eof()
		If Interrupcao(@lEnd)
			Loop
	   	Endif  
		If Subs(SF3->F3_CFO,1,1)=="6"
			If SF3->F3_TIPO$"DB"
				SA2->(MsSeek(xFilial("SA2")+SF3->F3_CLIEFOR+SF3->F3_LOJA)) 
			Else
				SA1->(MsSeek(xFilial("SA1")+SF3->F3_CLIEFOR+SF3->F3_LOJA))
			EndIf	
			//
	        lImprime :=(SF3->F3_TIPO$"DB",Empty(SA2->A2_CODMUN),Empty(SA1->A1_SUFRAMA))
	        //
	        If lImprime
				cTipo        := "0220"
				cCod_UF      := SF3->F3_ESTADO

				If SF3->F3_TIPO$"DB" //Caso seja DevoluГЦo ou Beneficiamento, deverЦo ser observados o cadastro de Fornecedor
					If SA2->A2_CONTRIB == "1"
						lContrib := .T.
					ElseIf SA2->A2_CONTRIB == "2"
						lContrib := .F.
					ElseIf LEFT(AllTrim(SA2->A2_INSCR),1) $ "1234567890"  //Caso o campo A2_CONTRIB esteja em branco, serА observado se a IE estА preenchida.
						lContrib := .T.
					Else
						lContrib := .F.
					EndIf
				Else
					If SA1->A1_CONTRIB == "1"
						lContrib := .T.
					ElseIf SA1->A1_CONTRIB == "2"
						lContrib := .F.
					ElseIf LEFT(AllTrim(SA1->A1_INSCR),1) $ "1234567890"  //Caso o campo A1_CONTRIB esteja em branco, serА observado se a IE estА preenchida.
						lContrib := .T.
					Else
						lContrib := .F.
					EndIf
				EndIf

				nValCtaNcont := IIF(lContrib,0				,SF3->F3_VALCONT)
				nValCtaContr := IIF(lContrib,SF3->F3_VALCONT,0)
				nValBasNcont := IIF(lContrib,0				,SF3->F3_BASEICM)
				nValBasContr := IIF(lContrib,SF3->F3_BASEICM,0)
				nVal_OutraOP := ( SF3->F3_OUTRICM  + SF3->F3_ISENICM )
				nVal_ImpST   := SF3->F3_ICMSRET
				//
				nTotCtaN	+=	nValCtaNcont
				nTotCta		+=	nValCtaContr
				nTotBNC		+=	nValBasNcont
				nTotBC		+=	nValBasContr
				nTotOut		+=	nVal_OutraOP
				nTotSt		+=	nVal_ImpST
			   	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			   	//Ё Rotina de Impressao do Registro 0220                         Ё
			   	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			    IncRegua()
				//		
			   	If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
			   		If (nLin>=nLinPag)
						FmtLin({},al[139],,,@nLin)	
						nLin := 2
			   		EndIf
					R915Cabec(aL,@nLin,@nPagina,cTipo)
			   	Endif                  
				nDados	:= ascan(aDados,{|x| x[1]=cCod_UF})
				If nDados == 0
					aAdd(aDados,{cCod_UF,nValCtaNcont,nValCtaContr,nValBasNcont,nValBasContr,nVal_OutraOP,nVal_ImpST})
				Else	
				   aDados[nDados][2]+=nValCtaNcont
				   aDados[nDados][3]+=nValCtaContr
				   aDados[nDados][4]+=nValBasNcont
				   aDados[nDados][5]+=nValBasContr
				   aDados[nDados][6]+=nVal_OutraOP
				   aDados[nDados][7]+=nVal_ImpST
				EndIf            	
			   	nTotReg += 1
			   	nSomaVal+= SF3->F3_VALCONT+SF3->F3_BASEICM+SF3->F3_OUTRICM+SF3->F3_ICMSRET             
			Endif	   	
		EndIf   	
		DbSkip() 
	EndDo
	
	For nI:=1 to len(aDados)
	    IncRegua()
		//		
	   	If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
	   		If (nLin>=nLinPag)
				FmtLin({},al[139],,,@nLin)	
				nLin := 2
	   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
	   	Endif  
		//
	  	FmtLin(aDados[nI],al[138],,,@nLin)
	Next nI 
		//
	
	//
	If (lImprime)
		FmtLin({},al[137],,,@nLin)
		FmtLin({"", nTotCtaN, nTotCta, nTotBNC, nTotBC, nTotOut, nTotSt}, al[138],,,@nLin) 
		FmtLin({},al[139],,,@nLin)	
	EndIf   
	//
	FsQuery(_aTotal,2)
Return
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0230  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de Saidas para ZFM/ALC            Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0230(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cCod_Local  := ""
	Local cNum_SerNF  := ""
	Local cNum_SubNF  := ""
	Local cNum_NF     := ""
	Local cDt_Emiss   := ""
	Local nVal_NF     := 0
	Local nVal_Isenta := 0
	Local cCNPJ       := ""
	Local cInsc_SUFRAM:= ""
	Local _aTotal     := {}
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotValCont	:=	0
	Local	nTotIsenta	:=	0
	//
	cTipo := ""
	//
	DbSelectArea("SX5")
	SX5->(dbSetOrder(1)) 
	DbSelectArea("SA1")
	SA1->(dbSetOrder(1))
	DbSelectArea("SA2")
	SA2->(dbSetOrder(1))
	DbSelectArea("SF3")
	SF3->(dbSetOrder(1))
	//
	_aTotal := {"SF3",""}
	FsQuery(_aTotal,1,"F3_FILIAL='"+xFilial("SF3")+"' And F3_EMISSAO>='"+Dtos(dDtIni)+"' And F3_EMISSAO<='"+Dtos(dDtFim)+"'","F3_FILIAL=='"+ xFilial("SF3") +"' .and. DTOS(F3_EMISSAO)>='"+ DTOS(dDtIni) +"' .and. DTOS(F3_EMISSAO)<='"+ DTOS(dDtFim) +"'",SF3->(IndexKey()))
	//
	SetRegua(LastRec())
	SF3->(DbGoTop())
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
	   	Endif 
		If Subs(SF3->F3_CFO,1,1)=="6"
			If SF3->F3_TIPO$"DB"
				SA2->(MsSeek(xFilial("SA2")+SF3->F3_CLIEFOR+SF3->F3_LOJA)) 
			Else
				SA1->(MsSeek(xFilial("SA1")+SF3->F3_CLIEFOR+SF3->F3_LOJA))
			EndIf        
			//
			lImprime := (SF3->F3_TIPO$"DB",!Empty(SA2->A2_CODLOC),!Empty(SA1->A1_CODLOC)) .And. (SF3->F3_TIPO$"DB",!Empty(SA2->A2_CODMUN),!Empty(SA1->A1_SUFRAMA))
			//
			If lImprime
				SX5->(MsSeek(xFilial("SX5")+"AB"+IIf(SF3->F3_TIPO$"DB",Subs(SA2->A2_CODLOC,5,4),Subs(SA1->A1_CODLOC,5,4))))
				cTipo       := "0230"
				cCod_Local  := SUBS(SX5->X5_DESCRI,1,8)
				cNum_SerNF  := SerieNfId("SF3",2,"F3_SERIE")
				cNum_SubNF  := Space(002)
				cNum_NF     := SF3->F3_NFISCAL
				cDt_Emiss   := Dtos(SF3->F3_EMISSAO)+StrTran(Time(),":","")
				nVal_NF     := SF3->F3_VALCONT
				nVal_Isenta := SF3->F3_ISENICM
				cCNPJ       := Iif(SF3->F3_TIPO$"DB",SA2->A2_CGC,SA1->A1_CGC)
				cInsc_SUFRAM:= Iif(SF3->F3_TIPO$"DB",SPACE(09),SA1->A1_SUFRAMA)
				//
				nTotValCont+=	SF3->F3_VALCONT
				nTotIsenta +=	SF3->F3_ISENICM
			   	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			   	//Ё Rotina de Impressao do Registro 0230                         Ё
			   	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			   	IncRegua()
				//
			   	If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
			   		If (nLin>=nLinPag)
						FmtLin({},al[149],,,@nLin)	
						nLin := 2
			   		EndIf
				   R915Cabec(aL,@nLin,@nPagina,cTipo)
			   	Endif                  
				//
			   	FmtLin({cCod_Local,cNum_SerNF,cNum_SubNF,cNum_NF,cDt_Emiss,nVal_NF,nVal_Isenta,cInsc_SUFRAM,cCNPJ},al[148],,,@nLin) 
				//
			    nTotReg += 1
			    nSomaVal+= SF3->F3_VALCONT+SF3->F3_ISENICM
			Endif   
		EndIf   	
		DbSkip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[147],,,@nLin)
		FmtLin({"", "", "", "", "", nTotValCont, nTotIsenta, "", ""},al[148],,,@nLin) 
		FmtLin({},al[149],,,@nLin)	
	EndIf   
	//	
	FsQuery(_aTotal,2)
	SF3->(DbGoTop())
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0240  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de SCE Compensado entre           Ё╠╠
╠╠Ё          Ё Estabelecimentos                                           Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0240(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local cObs_SCE    := ""
	Local cNum_Inscr  := ""      
	Local cNum_SerNF  := ""
	Local cNum_SubNF  := ""
	Local cNum_NF     := ""
	Local nVal_Compen := 0
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotValCont	:=	0
	//		
	cTipo := ""
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop()
	//
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If Subs(SF3->F3_CFO,1,1)== ""
			lImprime    := .T.
			cTipo       := "0240"
			cSeq_Ocorr  := Alltrim(StrTran(PUR->SUBCOD,".",""))
			cObs_SCE    := Space(10) //Space(100)
			cNum_Inscr  := SA1->A1_INSCR      
			cNum_SerNF  := SerieNfId("SF3",2,"F3_SERIE")
			cNum_SubNF  := Space(002)
			cNum_NF     := SF3->F3_NFISCAL
			nVal_Compen := SF3->F3_VALCONT
			//
			nTotValCont	+=	SF3->F3_VALCONT
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0240                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[159],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cSeq_Ocorr,cObs_SCE,cNum_Inscr,cNum_SerNF,cNum_SubNF,cNum_NF,nVal_Compen},al[158],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= SF3->F3_VALCONT
		EndIf   	
		DbSkip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[157],,,@nLin)
		FmtLin({"", "", "", "", "", "", nTotValCont},al[158],,,@nLin) 
		FmtLin({},al[159],,,@nLin)	
	EndIf   
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0250  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de SCE Compensado do Proprio      Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0250(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local cObs        := ""
	Local nVal_Compen := 0
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotValCont	:=	0
	//
	cTipo := ""
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop()
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If Subs(SF3->F3_CFO,1,1)== ""
	 		lImprime    := .T.
			cTipo       := "0250"
			cSeq_Ocorr  := Alltrim(StrTran(PUR->SUBCOD,".",""))
			cObs        := Space(10)
			nVal_Compen := ICM->VALCONT	
			//
			nTotValCont	+=	ICM->VALCONT	
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0250                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//			
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[169],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cSeq_Ocorr,cObs,nVal_Compen},al[168],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= ICM->VALCONT
		EndIf   	
		DbSkip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[167],,,@nLin)
		FmtLin({"", "", nTotValCont},al[168],,,@nLin) 
		FmtLin({},al[169],,,@nLin)	
	EndIf  
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0260  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de SCE Compensado do Proprio      Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0260(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local cObs        := ""
	Local nNum_Inscr  := 0      
	Local cNum_SerNF  := ""
	Local cNum_SubNF  := ""
	Local cNum_NF     := ""
	Local cPref_Proc  := ""
	Local nNum_Proc   := 0
	Local nAno_Proc   := 0
	Local nVal_SaldRec:= 0 
	Local lImprime    := .F.
	Local 	aL := R915LayOut()
	Local	nTotValCont	:=	0
	//
	cTipo := ""
	//
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop()
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif 
		If Subs(SF3->F3_CFO,1,1)== ""
			lImprime    := .T.
			cTipo       :="0260"
			cSeq_Ocorr  := Alltrim(StrTran(PUR->SUBCOD,".",""))
			cObs        := Space(10)//Space(100)
			nNum_Inscr  := 0      
			cNum_SerNF  := ICM->&(SerieNfId("SF3",3,"F3_SERIE")) 
			cNum_SubNF  := Space(002)
			cNum_NF     := ICM->F3_NFISCAL
			cPref_Proc  := "E-04"
			nNum_Proc   := 0
			nAno_Proc   := 0
			nVal_SaldRec:= ICM->VALCONT 
			//
			nTotValCont	+=	ICM->VALCONT 
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0260                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[179],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cSeq_Ocorr,cObs,nNum_Inscr,cNum_SerNF,cNum_SubNF,cNum_NF,cPref_Proc,nNum_Proc,nAno_Proc,nVal_SaldRec},al[178],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= ICM->VALCONT
		EndIf   	
		DbSkip()
	EndDo
	//
	If (lImprime)
		FmtLin({},al[177],,,@nLin)
		FmtLin({"", "", "", "", "", "", "", "", "", nTotValCont},al[178],,,@nLin) 
		FmtLin({},al[179],,,@nLin)	
	EndIf 
Return

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё Reg0270  Ё Autor Ё Eduardo Ju            Ё Data Ё 15.08.03 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Registro de Movimentacao de SCE Transferido                Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Static Function Reg0270(nLinPag)
	Local cTipo       := ""
	Local nLin        := 0
	Local cSeq_Ocorr  := ""
	Local cSeq_OcorDes:= 0
	Local cObs        := ""
	Local cNum_SerNF  := ""
	Local cNum_SubNF  := ""
	Local cNum_NF     := ""
	Local cPref_Proc  := ""
	Local nNum_Proc   := 0
	Local nAno_Proc   := 0
	Local nVal_Transf := 0
	Local lImprime    := .F.
	Local	aL := R915LayOut()
	Local	nTotValCont	:=	0
	//
	cTipo := ""
	//
	DbSelectArea("ICM")
	SetRegua(LastRec())
	DbGoTop()
	While !Eof() 
		If Interrupcao(@lEnd)
			Loop
		Endif
		If Subs(SF3->F3_CFO,1,1)== ""
			lImprime    := .T.
			cTipo :="0270"
			cSeq_Ocorr  := Alltrim(StrTran(PUR->SUBCOD,".",""))
			cSeq_OcorDes:= "0"
			cObs        := Space(10) //Space(100) 
			cNum_SerNF  := ICM->&(SerieNfId("SF3",3,"F3_SERIE"))
			cNum_SubNF  := Space(002)
			cNum_NF     := ICM->F3_NFISCAL
			cPref_Proc  := "E-04"
			nNum_Proc   := 0
			nAno_Proc   := 0
			nVal_Transf := ICM->VALCONT
	        //
	        nTotValCont	+=	ICM->VALCONT
			//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
			//Ё Rotina de Impressao do Registro 0270                         Ё
			//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
			IncRegua()
			//
			If (nLin == 0 .And. lImprime) .Or. (nLin>=nLinPag)
		   		If (nLin>=nLinPag)
					FmtLin({},al[189],,,@nLin)	
					nLin := 2
		   		EndIf
				R915Cabec(aL,@nLin,@nPagina,cTipo)
			Endif                  
			//
			FmtLin({cSeq_Ocorr,cSeq_OcorDes,cObs,cNum_SerNF,cNum_SubNF,cNum_NF,cPref_Proc,nNum_Proc,nAno_Proc,nVal_Transf},al[188],,,@nLin) 
			//
			nTotReg += 1
			nSomaVal+= ICM->VALCONT
		EndIf   	
		DbSkip()
	EndDo 
	//
	If (lImprime)
		FmtLin({},al[187],,,@nLin)
		FmtLin({"", "", "", "", "", "", "", "", "", nTotValCont},al[188],,,@nLin) 
		FmtLin({},al[189],,,@nLin)	
	EndIf 
Return
/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддддбддддддбддддддддддддддддддддддбддддбдддддддддд©╠╠
╠╠ЁFuncao    Ё R915LayOut   ЁAutor Ё Eduardo Ju           ЁDataЁ 05.08.03 Ё╠╠
╠╠цддддддддддеддддддддддддддаддддддаддддддддддддддддддддддаддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Armazena LayOut da Listagem de Conferencia da GiaRJ        Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё MATR915                                                    Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function R915LayOut()
	Local	aL	:=	Array (198)
						//           1         2         3         4         5         6         7         8         9        10        11        12        13        14        15        16        17        18        19        20        21        22
						// 01234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
	al[01] := STR0008 	//"                      						 Listagem de Conferencia da Gia - RJ       								   Pag.: #### "
	al[02] := STR0009 	//"                                                                               													  "
	al[03] := STR0010 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[04] := STR0011 	//"ЁRegistro: 0110 ЁRegistro Identificador da Declaracao                        													 Ё"
	al[05] := STR0012 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[06] := STR0013 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[07] := STR0014 	//"ЁInscricao Estadual:                 ########                                                                                     Ё"
	al[08] := STR0015 	//"ЁAno de Referencia:                  ####																						 Ё"
	al[09] := STR0016 	//"ЁMes de Referencia:                  ##																							 Ё"
	al[10] := STR0017 	//"ЁIndicador de Retificadora:          #                                                                                            Ё"
	al[11] := STR0018 	//"ЁNome do Representante Legal:        ################################################################							 Ё"
	al[12] := STR0019  	//"ЁDDD do Representante Legal:         ####																						 Ё"
	al[13] := STR0020  	//"ЁTelefone do Representante Legal:    ########																					 Ё"
	al[14] := STR0021  	//"ЁNome do Contabilista:				################################################################							 Ё"
	al[15] := STR0022	//"ЁCorreio Eletronico:					########################################													 Ё"
	al[16] := STR0023  	//"ЁDDD do Contabilista:                ####                                           												 Ё"
	al[17] := STR0024  	//"ЁTelefone do Contabilista:			########                                                                                     Ё"
	al[18] := STR0025 	//"ЁValor do Saldo Anterior:			###############                                      										 Ё"
	al[19] := STR0026	//"ЁValor do Saldo Anterior ST:			###############																				 Ё"
	al[20] := STR0027	//"ЁObservacao:							##########################################################################################	 Ё"
	al[21] := STR0028  	//"ЁObservacao ST:						##########################################################################################	 Ё"
	al[22] := STR0029 	//"ЁValor do Saldo Anterior SCE:		###############																				 Ё"
	al[23] := STR0030	//"|Valor do Credito de Energia SCE:    ###############                                                                              |"      
	al[24] := STR0031	//"ЁValor do Estorno de Provisao SCE:	###############																				 Ё"
	al[25] := STR0032	//"ЁValor de Provisao SCE:				###############                                                                              Ё"
	al[26] := STR0033  	//"ЁInd. Mov. Operacoes Proprias:       #                                                                                            Ё"
	al[27] := STR0034	//"ЁInd. Mov. Substituicao Tributaria:  #                                                                                            Ё"
	al[28] := STR0035	//"ЁInd. Mov. Outros ICMS:              #                                                                                          	 Ё"
	al[29] := STR0036	//"ЁInd. Mov. ALC/ZFM:	                #                                                                                          	 Ё"
	al[30] := STR0037	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[31] := STR0038	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[32] := STR0039 	//"ЁRegistro: 0120 ЁRegistro de Movimentacao de Entradas                        												     Ё"
	al[33] := STR0040 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[34] := STR0041 	//"+------------------------------------------------------------------------------------------+"
  	al[35] := STR0042  	//"|CFOP |     Valor      Ё Valor da Base  Ё   Valor  do    Ё  Valor de Op.  Ё Valor de OutrasЁ"
  	al[36] := STR0043  	//"Ё     Ё    Contabil    Ё  de  Calculo   Ё    Imposto	    Ё    Isentas	 Ё	  Operacoes	  Ё"
  	al[37] := STR0044 	//"+-----+----------------+----------------+----------------+----------------+----------------+"
  	al[38] := STR0045  	//"Ё#### Ё############### Ё############### Ё############### Ё############### Ё############### Ё" 
   	al[39] := STR0046 	//"+------------------------------------------------------------------------------------------+"    
   	al[40] := STR0047 	//"                                                                               													  "
   	al[41] := STR0048	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[42] := STR0049 	//"ЁRegistro: 0130 ЁRegistro de Movimentacao de Saidas                        													 	 Ё"
	al[43] := STR0050 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[44] := STR0051 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
  	al[45] := STR0052  	//"ЁCFOP Ё     Valor      Ё Valor da Base  Ё   Valor  do    Ё  Valor de Op.  Ё Valor de OutrasЁ Valor da Base  Ё Valor do Imposto    Ё"
  	al[46] := STR0053  	//"Ё     Ё    Contabil    Ё  de  Calculo   Ё    Imposto	    Ё    Isentas	 Ё	  Operacoes	  Ё de Calculo ST  Ё    Retido ST		 Ё"
  	al[47] := STR0054 	//"+-----+----------------+----------------+----------------+----------------+----------------+----------------+---------------------+"
  	al[48] := STR0055  	//"Ё#### Ё############### Ё############### Ё############### Ё############### Ё############### Ё############### Ё###############      Ё 
   	al[49] := STR0056 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
   	al[50] := STR0057 	//"                                                                               													  "
	al[51] := STR0058	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[52] := STR0059 	//"ЁRegistro: 0140 ЁRegistro de Movimentacao de Outros Debitos              													 	 													  	Ё"
	al[53] := STR0060 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[54] := STR0061 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[55] := STR0062  	//"ЁSequencial da Ё    Valor de    Ё Descricao    																					                                                        Ё"
  	al[56] := STR0063  	//"Ё Ocorrencia   Ё  Outro Debito  Ё Complementar 																					                                                        Ё"   
  	al[57] := STR0064 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[58] := STR0065  	//"Ё	#####     Ё############### Ё######################################################################################################################################################  Ё"
   	al[59] := STR0066 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
   	al[60] := STR0067 	//"                                                                               													                                                         "
	al[61] := STR0068	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[62] := STR0069 	//"ЁRegistro: 0150 ЁRegistro de Movimentacao de Estornos Credito              													 	 													  	Ё"
	al[63] := STR0070 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[64] := STR0071 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[65] := STR0072  	//"ЁSequencial da Ё    Valor de    Ё Descricao    																					                                                        Ё"
  	al[66] := STR0073  	//"Ё Ocorrencia   ЁEstorno Credito Ё Complementar 																					                                                        Ё"   
  	al[67] := STR0074 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[68] := STR0075  	//"Ё	#####     Ё############### Ё######################################################################################################################################################  Ё"
   	al[69] := STR0076 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[70] := STR0077 	//"                                                                               													                                                         "
   	al[71] := STR0078  	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[72] := STR0079 	//"ЁRegistro: 0160 ЁRegistro de Movimentacao de Outros Creditos              													 	 													  	Ё"
	al[73] := STR0080 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[74] := STR0081 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[75] := STR0082  	//"ЁSequencial da Ё   Valor de     Ё Descricao    																					                                                        Ё"
  	al[76] := STR0083  	//"Ё Ocorrencia   Ё Outro Credito  Ё Complementar 																					                                                        Ё"   
  	al[77] := STR0084 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[78] := STR0085  	//"Ё	#####     Ё############### Ё######################################################################################################################################################  Ё"
   	al[79] := STR0086 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[80] := STR0087 	//"                                                                               													                                                         "
	al[81] := STR0088 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[82] := STR0089 	//"ЁRegistro: 0170 ЁRegistro de Movimentacao de Estornos Debito              													 	 													  	Ё"
	al[83] := STR0090 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[84] := STR0091 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[85] := STR0092  	//"ЁSequencial da Ё   Valor de     Ё Descricao    																					                                                        Ё"
  	al[86] := STR0093  	//"Ё Ocorrencia   ЁEstorno Debito  Ё Complementar 																					                                                        Ё"   
  	al[87] := STR0094 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[88] := STR0095  	//"Ё	#####     Ё############### Ё######################################################################################################################################################  Ё"
   	al[89] := STR0096 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[90] := STR0097 	//"                                                                               													                                                         "
	al[91] := STR0098 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[92] := STR0099 	//"ЁRegistro: 0180 ЁRegistro de Movimentacao de Deducoes              													 	 													  	        Ё"
	al[93] := STR0100 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[94] := STR0101 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[95] := STR0102  	//"ЁSequencial da Ё   Valor de     Ё Descricao    																					                                                        Ё"
  	al[96] := STR0103  	//"Ё Ocorrencia   Ё    Deducao     Ё Complementar 																					                                                        Ё"   
  	al[97] := STR0104 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[98] := STR0105  	//"Ё	#####     Ё############### Ё######################################################################################################################################################  Ё"
   	al[99] := STR0106 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[100]:= STR0107 	//"                                                                               													                                                         "
   	al[101]:= STR0108 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[102]:= STR0109 	//"ЁRegistro: 0190 ЁRegistro de Movimentacao de Operacoes com Prazo Especial              													 	 										    Ё"
	al[103]:= STR0110 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[104]:= STR0111 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[105]:= STR0112  	//"ЁSequencial da Ё    Valor de    Ё Descricao    																					                                                        Ё"
  	al[106]:= STR0113  	//"Ё Ocorrencia   Ё Prazo Especial Ё Complementar 																					                                                        Ё"   
  	al[107]:= STR0114 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[108]:= STR0115  	//"Ё	#####     Ё############### Ё######################################################################################################################################################  Ё"
   	al[109]:= STR0116 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[110]:= STR0117 	//"                                                                               													                                                         "
 	al[111]:= STR0118	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[112]:= STR0119 	//"ЁRegistro: 0200 ЁRegistro de Movimentacao de Outros ICMS devido              													 	 										            Ё"
	al[113]:= STR0120 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[114]:= STR0121 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[115]:= STR0122  	//"ЁSequencial da Ё    Valor de    Ё Descricao    																					                                                        Ё"
  	al[116]:= STR0123  	//"Ё Ocorrencia   Ё   Lancamento   Ё Complementar 																					                                                        Ё"   
  	al[117]:= STR0124 	//"+--------------+----------------+--------------------------------------------------------------------------------------------------------------------------------------------------------+"
  	al[118]:= STR0125  	//"|   #####      |################|########################################################################################################################################################|"
   	al[119]:= STR0126 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[120]:= STR0127 	//"                                                                               													                                                         "
	al[121]:= STR0128 	//"+-------------------------------------------------------------------------+"
	al[122]:= STR0129 	//"ЁRegistro: 0210 ЁRegistro de Movimentacao de Entradas Interestaduais      Ё"
	al[123]:= STR0130 	//"+-------------------------------------------------------------------------+"
	al[124]:= STR0131 	//"+-------------------------------------------------------------------------+"
  	al[125]:= STR0132  	//"Ё UF  Ё     Valor      Ё Valor da Base  ЁValor de Outras ЁValor de Outros Ё"
  	al[126]:= STR0133  	//"Ё     Ё    Contabil    Ё  de  Calculo   Ё   Operacoes    Ё   Produtos     Ё"
  	al[127]:= STR0134 	//"+-----+----------------+----------------+----------------+----------------+"
  	al[128]:= STR0135  	//"Ё ### |############### Ё############### Ё############### Ё############### Ё 
   	al[129]:= STR0136 	//"+-------------------------------------------------------------------------+"          
   	al[130]:= STR0137  	//"																			  "	
	al[131]:= STR0138	//"+-----------------------------------------------------------------------------------------------------------+"
	al[132]:= STR0139 	//"ЁRegistro: 0220 ЁRegistro de Movimentacao de Saidas Interestaduais                        				   Ё"
	al[133]:= STR0140 	//"+-----------------------------------------------------------------------------------------------------------+"
	al[134]:= STR0141 	//"+-----------------------------------------------------------------------------------------------------------+"
  	al[135]:= STR0142 	//"Ё UF  Ё Valor Contabil Ё Valor Contabil ЁValor Base Calc.ЁValor Base Calc.Ё Valor de OutrasЁValor do ImpostoЁ"
  	al[136]:= STR0143 	//"Ё     ЁNao ContribuinteЁ  Contribuinte  ЁNao ContribuinteЁ Contribuinte	 Ё	  Operacoes	  Ё   Cobrado ST   Ё"
  	al[137]:= STR0144 	//"+-----+----------------+----------------+----------------+----------------+----------------+----------------+"
  	al[138]:= STR0145 	//"Ё ### Ё############### Ё############### Ё############### Ё############### Ё############### Ё############### Ё 
   	al[139]:= STR0146 	//"+-----------------------------------------------------------------------------------------------------------+"
   	al[140]:= STR0147 	//"                                                                               							    "	 
	al[141]:= STR0148	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[142]:= STR0149 	//"ЁRegistro: 0230 ЁRegistro de Movimentacao de Saidas para ZFM/ALC                        											 Ё"
	al[143]:= STR0150 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[144]:= STR0151 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
  	al[145]:= STR0152  	//"ЁCodigo da ЁSerie Ё Subserie Ё Numero Ё   Data de     Ё Valor da Nota  Ё   Valor de     Ё  Numero do    Ё    Numero de Inscr. 	 Ё"
  	al[146]:= STR0153  	//"ЁLocalidadeЁda NF Ё  da NF   Ё da NF  Ё   Emissao	 Ё	  Fiscal	  Ё   Isentas      Ё    CNPJ       Ё       Suframa           Ё"		
	al[147]:= STR0154	//"+----------+------+----------+--------+---------------+----------------+----------------+---------------+-------------------------+"
  	al[148]:= STR0155  	//"Ё ######## Ё ###  Ё   ##     Ё ###### Ё############## Ё############### Ё############### Ё############## Ё     ############        Ё"
   	al[149]:= STR0156 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
   	al[150]:= STR0157 	//"                                                                               													  "
	al[151]:= STR0158	//"+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[152]:= STR0159 	//"ЁRegistro: 0240 ЁRegistro de Movimentacao de SCE Compensado entre Estabelecimentos                        						                                          Ё"
	al[153]:= STR0160 	//"+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[154]:= STR0161 	//"+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[155]:= STR0162  	//"ЁSequencial da ЁObservacao                                                                                           ЁNumero de ЁSerie Ё SubserieЁ Numero Ё     Valor   	  Ё"                                                                                                                
  	al[156]:= STR0163  	//"Ё Ocorrencia   Ё                                                                                               		ЁInscricao Ёda NF Ё  da NF  Ё da NF  Ё   Compensado   Ё"   
  	al[157]:= STR0164 	//"+--------------+-----------------------------------------------------------------------------------------------------+----------+------+---------+--------+----------------+"
  	al[158]:= STR0165  	//"Ё	#####     Ё#################################################################################################### Ё ######## Ё ###  Ё   ##    Ё ###### Ё ###############Ё"
   	al[159]:= STR0166 	//"+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
   	al[160]:= STR0167 	//"                                                                               													                                           "
   	al[161]:= STR0168	//"+------------------------------------------------------------------------------------------------------------------------------------+"
	al[162]:= STR0169 	//"ЁRegistro: 0250 ЁRegistro de Movimentacao de SCE Compensado do Proprio             													Ё"
	al[163]:= STR0170 	//"+------------------------------------------------------------------------------------------------------------------------------------+"
	al[164]:= STR0171 	//"+------------------------------------------------------------------------------------------------------------------------------------+"
	al[165]:= STR0172  	//"ЁSequencial da ЁObservacao 																		                   Ё     Valor      Ё"
  	al[166]:= STR0173  	//"Ё Ocorrencia   Ё                                                                                                    Ё   Compensado   Ё"   
  	al[167]:= STR0174 	//"+--------------+----------------------------------------------------------------------------------------------------+----------------+"
  	al[168]:= STR0175  	//"Ё	#####     Ё####################################################################################################Ё############### Ё"
   	al[169]:= STR0176 	//"+------------------------------------------------------------------------------------------------------------------------------------+"
	al[170]:= STR0177 	//"                                                                               													     "
 	al[171]:= STR0178 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[172]:= STR0179 	//"ЁRegistro: 0260 ЁRegistro de Movimentacao de SCE Recebido                        						                                                                                                              Ё"
	al[173]:= STR0180 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[174]:= STR0181 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[175]:= STR0182  	//"ЁSequencial da ЁObservacao                                                                                           ЁNumero de ЁSerie Ё SubserieЁ Numero ЁCod. PrefixoЁ    Numero do       ЁAno do   Ё  Valor         Ё"                                                                                                                
  	al[176]:= STR0183  	//"Ё Ocorrencia   Ё                                                                                               		ЁInscricao Ёda NF Ё  da NF  Ё da NF  Ёdo Processo Ё    Processo        ЁProcesso Ё  Compensado    Ё"   
  	al[177]:= STR0184 	//"+--------------+-----------------------------------------------------------------------------------------------------+----------+------+---------+--------+------------+--------------------+---------+----------------+"
  	al[178]:= STR0185  	//"Ё	#####     Ё#################################################################################################### Ё ######## Ё ###  Ё   ##    Ё ###### Ё ########## Ё####################Ё ####    Ё############### Ё"
   	al[179]:= STR0186 	//"+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
   	al[180]:= STR0187 	//"                                                                               													                                                                                       "  
	al[181]:= STR0188	//"+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[182]:= STR0189 	//"ЁRegistro: 0270 ЁRegistro de Movimentacao de SCE Transferido                        						                                                                                                                 Ё"
	al[183]:= STR0190 	//"+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[184]:= STR0191 	//"+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
	al[185]:= STR0192  	//"Ё Seq. da  ЁSeq.Ocor.ЁObservacao                                                                                          ЁNumero de ЁSerie ЁSubserie Ё Numero ЁCod. PrefixoЁ    Numero do       ЁAno do  Ё Valor do SaldoЁ"                                                                                                                
  	al[186]:= STR0193  	//"ЁOcorrenciaЁDestino  Ё                                                                                               	 ЁInscricao Ёda NF Ё da NF   Ё da NF  Ёdo Processo Ё    Processo        ЁProcessoЁ  Transferido  Ё"   
  	al[187]:= STR0194 	//"+----------+---------+----------------------------------------------------------------------------------------------------+----------+------+---------+--------+------------+--------------------+--------+---------------+"
  	al[188]:= STR0195  	//"Ё   #####  Ё #####   Ё####################################################################################################Ё ######## Ё ###  Ё  ##     Ё ###### Ё ########## Ё####################Ё ####   Ё###############Ё"
   	al[189]:= STR0196 	//"+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+"
   	al[190]:= STR0197 	//"                                                                               													                                                                                          "    
	al[191]:= STR0198	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[192]:= STR0199 	//"ЁRegistro: 9999 ЁRegistro Trailler do Arquivo                      										 						 Ё"
	al[193]:= STR0200 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[194]:= STR0201 	//"+---------------------------------------------------------------------------------------------------------------------------------+"
	al[195]:= STR0202  	//"ЁSomatorio dos Valores Informados:	#########################                                                                    Ё"
	al[196]:= STR0203  	//"ЁTotal de Declaracoes:				#####                                                                                        Ё"
	al[197]:= STR0204  	//"ЁTotal de Registros:   				#####                                                                                        Ё"
	al[198]:= STR0205  	//"+---------------------------------------------------------------------------------------------------------------------------------+"
Return (aL)

/*эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддддддбддддддбддддддддддддддддддддддбддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё R915Cabec    ЁAutor Ё Eduardo Ju           ЁDataЁ 05.08.03 Ё╠╠
╠╠цддддддддддеддддддддддддддаддддддаддддддддддддддддддддддаддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Imprime cabecalho do relatorio                             Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё MATR915                                                    Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function R915Cabec(aL,nLin,nPagina,cTipo)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Imprime caracter de controle de largura de impressao         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nLin:=0
@ nLin++,0 Psay AvalImp(220)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Imprime cabecalho do relatorio                               Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
    //Titulo do relatorio
	FmtLin({Transform(nPagina++,"@R 9999")},aL[01],,,@nLin)  
	FmtLin({},aL[02],,,@nLin)
	
	If cTipo == "0110"	//Registro 0110
		FmtLin({},aL[03],,,@nLin)
		FmtLin({},aL[04],,,@nLin)
		FmtLin({},al[05],,,@nLin)
		FmtLin({},al[06],,,@nLin)
	EndIf
	
	If cTipo == "0120"	//Registro 0120
		FmtLin({},aL[31],,,@nLin)
		FmtLin({},aL[32],,,@nLin)
		FmtLin({},al[33],,,@nLin)
		FmtLin({},al[34],,,@nLin)
		FmtLin({},al[35],,,@nLin)
		FmtLin({},al[36],,,@nLin)
		FmtLin({},al[37],,,@nLin)
	EndIf
		
	If cTipo == "0130"	//Registro 0130
		FmtLin({},aL[41],,,@nLin)
		FmtLin({},aL[42],,,@nLin)
		FmtLIn({},al[43],,,@nLin)
		FmtLIn({},al[44],,,@nLin)
		FmtLIn({},al[45],,,@nLin)
		FmtLIn({},al[46],,,@nLin)
		FmtLIn({},al[47],,,@nLin)
	EndIf
		
	If cTipo == "0140"	//Registro RegApur
		FmtLin({},aL[51],,,@nLin)
		FmtLin({},aL[52],,,@nLin)
		FmtLIn({},al[53],,,@nLin)
		FmtLIn({},al[54],,,@nLin)
		FmtLIn({},al[55],,,@nLin)
		FmtLIn({},al[56],,,@nLin)
		FmtLIn({},al[57],,,@nLin)
	EndIf
		
	If cTipo == "0190"	//Registro 0190
		FmtLin({},aL[101],,,@nLin)
		FmtLin({},aL[102],,,@nLin)
		FmtLIn({},al[103],,,@nLin)
		FmtLIn({},al[104],,,@nLin)
		FmtLIn({},al[105],,,@nLin)
		FmtLIn({},al[106],,,@nLin)
		FmtLIn({},al[107],,,@nLin)
	EndIf
	
	If cTipo == "0200"	//Registro 0200
		FmtLin({},aL[111],,,@nLin)
		FmtLin({},aL[112],,,@nLin)
		FmtLIn({},al[113],,,@nLin)
		FmtLIn({},al[114],,,@nLin)
		FmtLIn({},al[115],,,@nLin)
		FmtLIn({},al[116],,,@nLin)
		FmtLIn({},al[117],,,@nLin)
	EndIf	
	
	If cTipo == "0210"	//Registro 0210
		FmtLin({},aL[121],,,@nLin)
		FmtLin({},aL[122],,,@nLin)
		FmtLIn({},al[123],,,@nLin)
		FmtLIn({},al[124],,,@nLin)
		FmtLIn({},al[125],,,@nLin)
		FmtLIn({},al[126],,,@nLin)
		FmtLIn({},al[127],,,@nLin)
	EndIf
		
	If cTipo == "0220"	//Registro 0220
		FmtLin({},aL[131],,,@nLin)
		FmtLin({},aL[132],,,@nLin)
		FmtLin({},al[133],,,@nLin)
		FmtLin({},al[134],,,@nLin)
		FmtLin({},al[135],,,@nLin)
		FmtLin({},al[136],,,@nLin)
		FmtLin({},al[137],,,@nLin)
	EndIf	
	
	If cTipo == "0230"	//Registro 0230
		FmtLin({},aL[141],,,@nLin)
		FmtLin({},aL[142],,,@nLin)
		FmtLin({},al[143],,,@nLin)
		FmtLin({},al[144],,,@nLin)
		FmtLin({},al[145],,,@nLin)
		FmtLin({},al[146],,,@nLin)
		FmtLin({},al[147],,,@nLin)
	EndIf	 
	
	If cTipo == "0240"	//Registro 0240
		FmtLin({},aL[151],,,@nLin)
		FmtLin({},aL[152],,,@nLin)
		FmtLIn({},al[153],,,@nLin)
		FmtLIn({},al[154],,,@nLin)
		FmtLIn({},al[155],,,@nLin)
		FmtLIn({},al[156],,,@nLin)
		FmtLIn({},al[157],,,@nLin)
	EndIf	
	
	If cTipo == "0250"	//Registro 0250
		FmtLin({},aL[161],,,@nLin)
		FmtLin({},aL[162],,,@nLin)
		FmtLIn({},al[163],,,@nLin)
		FmtLIn({},al[164],,,@nLin)
		FmtLIn({},al[165],,,@nLin)
		FmtLIn({},al[166],,,@nLin)
		FmtLIn({},al[167],,,@nLin)		
	EndIf	
	
	If cTipo == "0260"	//Registro 0260
		FmtLin({},aL[171],,,@nLin)
		FmtLin({},aL[172],,,@nLin)
		FmtLIn({},al[173],,,@nLin)
		FmtLIn({},al[174],,,@nLin)
		FmtLIn({},al[175],,,@nLin)
		FmtLIn({},al[176],,,@nLin)
		FmtLIn({},al[177],,,@nLin)	
	Endif	  
	
	If cTipo == "0270"	//Registro 0270
		FmtLin({},aL[181],,,@nLin)
		FmtLin({},aL[182],,,@nLin)
		FmtLIn({},al[183],,,@nLin)
		FmtLIn({},al[184],,,@nLin)                
		
		FmtLIn({},al[185],,,@nLin)
		FmtLIn({},al[186],,,@nLin)
		FmtLIn({},al[187],,,@nLin)	
	EndIf
		
	If cTipo == "9999"	//Registro 9999
		FmtLin({},aL[191],,,@nLin)
		FmtLin({},aL[192],,,@nLin)
		FmtLIn({},al[193],,,@nLin)
		FmtLIn({},al[194],,,@nLin) 
	EndIf
	
Return (nil)
